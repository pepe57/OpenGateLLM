# ----------------------------------- models ------------------------------------
models:
  - name: albert-large
    type: image-text-to-text
    owned_by: test
    cost_prompt_tokens: 1
    cost_completion_tokens: 3
    aliases: ["mistralai/Mistral-Small-3.1-24B-Instruct-2503"]
    providers:
      - type: albert
        key: ${ALBERT_API_KEY}
        timeout: 120
        model_name: albert-large
        model_total_params: 24
        model_active_params: 24
        model_hosting_zone: FRA
        max_parallel_requests: 5
  
  - name: albert-small
    type: text-generation
    load_balancing_strategy: shuffle
    aliases: ["meta-llama/Llama-3.1-8B-Instruct"]
    cost_prompt_tokens: 1
    cost_completion_tokens: 3
    providers:
      - type: albert
        key: ${ALBERT_API_KEY}
        timeout: 120
        model_name: albert-small
        model_total_params: 8
        model_active_params: 8
        model_hosting_zone: FRA
        qos_metric: inflight
        qos_limit: 5

  - name: embeddings-small
    type: text-embeddings-inference
    aliases: ["BAAI/bge-m3"]
    cost_prompt_tokens: 1
    cost_completion_tokens: 3
    providers:
      - type: albert
        key: ${ALBERT_API_KEY}
        timeout: 120
        model_name: embeddings-small
        model_total_params: 8
        model_active_params: 8
        model_hosting_zone: FRA
        max_parallel_requests: 5

  - name: audio-large
    type: automatic-speech-recognition
    aliases: ["openai/whisper-large-v3"]
    providers:
      - type: albert
        key: ${ALBERT_API_KEY}
        timeout: 120
        model_name: audio-large
        model_total_params: 8
        model_active_params: 8
        model_hosting_zone: FRA
        max_parallel_requests: 5

  - name: rerank-small
    type: text-classification
    aliases: ["BAAI/bge-reranker-v2-m3"]
    providers:
      - type: albert
        key: ${ALBERT_API_KEY}
        timeout: 120
        model_name: rerank-small
        model_total_params: 8
        model_active_params: 8
        model_hosting_zone: FRA
        max_parallel_requests: 5

# -------------------------------- dependencies ---------------------------------
dependencies:
  postgres:
    url: postgresql+asyncpg://postgres:changeme@localhost:${POSTGRES_PORT:-5432}/postgres
    echo: False
    pool_size: 10
    max_overflow: 5
    pool_pre_ping: True
    pool_recycle: 3600 
    pool_reset_on_return: commit
    connect_args:
      server_settings:
        statement_timeout: "120s"
      command_timeout: 60

  redis:
    url: redis://:changeme@localhost:${REDIS_PORT:-6379}

  elasticsearch:
    hosts: http://localhost:${ELASTICSEARCH_PORT:-9200}
    basic_auth:
      - elasticsearch
      - changeme

  albert:
    headers:
      Authorization: Bearer ${ALBERT_API_KEY}

# ---------------------------------- settings -----------------------------------
settings:
  session_secret_key: -ftzKBct7qN22sgnkI9ApWD2ny_dHQVlPd2OPDSk5MM
  usage_tokenizer: tiktoken_gpt2
  log_level: DEBUG
  auth_key_max_expiration_days: 365
  monitoring_sentry_enabled: False
  monitoring_postgres_enabled: True
  monitoring_prometheus_enabled: True
  vector_store_model: embeddings-small
  search_multi_agents_synthesis_model: albert-large
  search_multi_agents_reranker_model: albert-small
